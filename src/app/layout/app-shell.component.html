<div class="workspace" (click)="closeMenus()">
  @if (isMobileNavOpen && !operationsOnly) {
    <button type="button" class="mobile-nav-backdrop" (click)="closeMobileNav()" aria-label="Close navigation"></button>
  }

  <aside class="sidebar" [class.open]="isMobileNavOpen" (click)="$event.stopPropagation()">
    <div class="sidebar-top">
      <a class="brand" [routerLink]="operationsOnly ? '/event-diary' : '/'" (click)="closeMobileNav()">
        <span class="brand-copy">
          <strong>{{ selectedVenueName }}</strong>
          <small>{{ operationsOnly ? 'Operations View' : 'Enquiry Management' }}</small>
        </span>
      </a>

      <label class="venue-field">
        <span>Venue</span>
        <select [ngModel]="selectedVenueId" (ngModelChange)="selectVenue($event)">
          @for (venue of venues; track venue.id) {
            <option [value]="venue.id">{{ venue.name }}</option>
          }
        </select>
      </label>

      @if (canCreateVenue) {
        <button type="button" class="superadmin-btn" (click)="openCreateVenueModal($event)">
          Superadmin: + New Venue
        </button>
      }
    </div>

    <div class="sidebar-scroll">
      <section class="sidebar-group">
        <p class="sidebar-heading">Workspace</p>
        <nav class="sidebar-nav">
          @for (item of primaryNavItems; track item.label) {
            @if (item.disabled) {
              <a
                aria-disabled="true"
                tabindex="-1"
                [attr.title]="item.disabledReason || 'Unavailable'"
                style="opacity:.45;cursor:not-allowed;pointer-events:none">
                <span>{{ item.label }}</span>
                @if (item.badge) {
                  <em class="badge">{{ item.badge }}</em>
                }
              </a>
            } @else if (item.route) {
              <a
                [routerLink]="item.route"
                routerLinkActive="active"
                [routerLinkActiveOptions]="{ exact: item.exact }"
                (click)="closeMobileNav()">
                <span>{{ item.label }}</span>
                @if (item.badge) {
                  <em class="badge">{{ item.badge }}</em>
                }
              </a>
            } @else if (item.externalUrl) {
              <a [href]="item.externalUrl" target="_blank" rel="noreferrer" (click)="closeMobileNav()">
                <span>{{ item.label }}</span>
                @if (item.badge) {
                  <em class="badge">{{ item.badge }}</em>
                }
              </a>
            }
          }
        </nav>
      </section>

      @if (!operationsOnly && reportNavItems.length > 0) {
        <section class="sidebar-group">
          <p class="sidebar-heading">Reports</p>
          <nav class="sidebar-nav">
            @for (item of reportNavItems; track item.label) {
              @if (item.disabled) {
                <a
                  aria-disabled="true"
                  tabindex="-1"
                  [attr.title]="item.disabledReason || 'Unavailable'"
                  style="opacity:.45;cursor:not-allowed;pointer-events:none">
                  <span>{{ item.label }}</span>
                </a>
              } @else if (item.route) {
                <a
                  [routerLink]="item.route"
                  routerLinkActive="active"
                  [routerLinkActiveOptions]="{ exact: item.exact }"
                  (click)="closeMobileNav()">
                  <span>{{ item.label }}</span>
                </a>
              } @else if (item.externalUrl) {
                <a [href]="item.externalUrl" target="_blank" rel="noreferrer" (click)="closeMobileNav()">
                  <span>{{ item.label }}</span>
                </a>
              }
            }
          </nav>
        </section>
      }

      @if (!operationsOnly && adminNavItems.length > 0) {
        <section class="sidebar-group">
          <p class="sidebar-heading">Administration</p>
          <nav class="sidebar-nav">
            @for (item of adminNavItems; track item.label) {
              <a
                [routerLink]="item.route"
                routerLinkActive="active"
                [routerLinkActiveOptions]="{ exact: item.exact }"
                (click)="closeMobileNav()">
                <span>{{ item.label }}</span>
              </a>
            }
          </nav>
        </section>
      }
    </div>

    <div class="sidebar-footer">
      <div class="sidebar-user-card">
        <span class="avatar">{{ initials }}</span>
        <span class="identity">
          <strong>{{ displayName }}</strong>
          <small>Signed in</small>
        </span>
      </div>
      <button type="button" class="signout-btn" (click)="logout()">Sign out</button>
    </div>
  </aside>

  <section class="main-panel">
    <header class="topbar" (click)="$event.stopPropagation()">
      <div class="topbar-inner">
        <div class="topbar-left">
          @if (!operationsOnly) {
            <button
              type="button"
              class="icon-btn mobile-nav-toggle"
              aria-label="Open navigation"
              [attr.aria-expanded]="isMobileNavOpen"
              (click)="toggleMobileNav($event)">
              &#9776;
            </button>
          }

          <div class="breadcrumbs">
            <span class="crumb-primary">Events</span>
            <span class="crumb-sep">&rsaquo;</span>
            <span class="crumb-muted">{{ selectedVenueName }}</span>
            <span class="crumb-sep">&rsaquo;</span>
            <span class="crumb-current">{{ currentSectionLabel }}</span>
          </div>
        </div>

        <div class="topbar-right">
          @if (!operationsOnly) {
            <div class="search-wrap" (click)="$event.stopPropagation()">
              <form class="search" (submit)="submitSearch($event)">
                <span class="search-icon">&#128269;</span>
                <input
                  type="text"
                  [ngModel]="searchQuery"
                  (ngModelChange)="onSearchInput($event)"
                  (focus)="onSearchFocus($event)"
                  name="globalSearch"
                  placeholder="Search naturally: weddings in March over 100 guests..."
                />
              </form>

              @if (isSearchOpen) {
                <div class="search-menu">
                  @if (searchIntent?.isNaturalLanguage) {
                    <div class="search-intent">
                      <strong>Understood: {{ searchIntent?.intentLabel || 'Natural language query' }}</strong>
                      @if (searchIntent?.suggestedRoute) {
                        <button type="button" class="inline-link" (click)="openSearchIntentRoute()">Open filtered view</button>
                      }
                    </div>
                  }

                  @if (searchQuery.trim().length < 3 && recentSearches.length > 0) {
                    <div class="search-section-title">Recent searches</div>
                    @for (query of recentSearches; track query) {
                      <button type="button" (click)="useRecentSearch(query)">
                        <strong>{{ query }}</strong>
                      </button>
                    }
                  }

                  @for (group of searchGroups; track group.type) {
                    <div class="search-section-title">{{ group.type }}</div>
                    @for (result of group.results; track result.entityId) {
                      <button type="button" (click)="openSearchResult(result)">
                        <strong>{{ result.primaryText }}</strong>
                        @if (result.secondaryText) {
                          <span>{{ result.secondaryText }}</span>
                        }
                      </button>
                    }
                  }

                  @if (searchQuery.trim().length >= 3 && searchGroups.length === 0) {
                    <p class="empty">No results found.</p>
                  }
                </div>
              }
            </div>

            <div class="recent-wrap" (click)="$event.stopPropagation()">
              <button class="icon-btn" (click)="toggleRecent()" aria-label="Recently viewed">&#128337;</button>
              @if (isRecentOpen) {
                <div class="recent-menu">
                  <div class="recent-title">Recently viewed</div>
                  @for (item of recentItems; track item.entityId) {
                    <button (click)="openRecentItem(item)">
                      <strong>{{ item.label }}</strong>
                      <span>{{ item.secondaryLine }}</span>
                      @if (item.status) {
                        <em>{{ item.status }}</em>
                      }
                    </button>
                  }
                  @if (recentItems.length === 0) {
                    <p class="empty">No recent enquiries.</p>
                  }
                </div>
              }
            </div>

            <div class="notifications-wrap" (click)="$event.stopPropagation()">
              <button class="icon-btn" (click)="toggleNotifications($event)" aria-label="Notifications">&#128276;</button>
              @if (unreadNotifications > 0) {
                <span class="notification-badge">{{ unreadNotifications }}</span>
              }
              @if (isNotificationsOpen) {
                <div class="notifications-menu">
                  <div class="notifications-title">
                    <span>Notifications</span>
                    <button type="button" (click)="markAllNotificationsRead()">Mark all read</button>
                  </div>
                  @for (group of notificationGroups; track group.key) {
                    <div class="notifications-group-label">{{ group.label }}</div>
                    @for (item of group.items; track item.id) {
                      <button type="button" [class.unread]="!item.isRead" (click)="markNotificationRead(item)">
                        <strong>{{ item.title }}</strong>
                        <span>{{ item.body }}</span>
                        <em>{{ item.createdAtUtc | date: 'dd/MM HH:mm' }}</em>
                      </button>
                    }
                  }
                  @if (notifications.length === 0) {
                    <p class="empty">No notifications.</p>
                  }
                </div>
              }
            </div>

            <div class="assistant-wrap" (click)="$event.stopPropagation()">
              <button class="icon-btn" (click)="toggleAssistant($event)" aria-label="AI Assistant">&#10024;</button>
            </div>

            <div class="settings-wrap" (click)="$event.stopPropagation()">
              <button class="icon-btn" (click)="toggleSettings($event)" aria-label="Settings">&#9881;</button>
              @if (isSettingsOpen) {
                <div class="settings-menu">
                  <button type="button" (click)="openAdmin()">Administration</button>
                  <button type="button" (click)="openSettingsSection('venue-profile')">Venue Profile</button>
                  <button type="button" (click)="openSettingsSection('spaces')">Spaces & Combinations</button>
                  <button type="button" (click)="openSettingsSection('budgets')">Budgets & Targets</button>
                  <button type="button" (click)="openSettingsSection('payment-schedules')">Payment Schedules</button>
                  <button type="button" (click)="openSettingsSection('terms')">Terms & Conditions</button>
                  <button type="button" (click)="openSettingsSection('proposal-templates')">Proposal Templates</button>
                  <button type="button" (click)="openSettingsSection('planning-milestones')">Planning Milestones</button>
                  <button type="button" (click)="openSettingsSection('guest-profiles')">Guest Profiles</button>
                  <button type="button" (click)="openSettingsSection('report-configuration')">Report Configuration</button>
                  <button type="button" (click)="openSettingsSection('notifications')">Notifications</button>
                  <button type="button" (click)="openSettingsSection('automation')">Automation</button>
                  <button type="button" (click)="openSettingsSection('email-templates')">Email Templates</button>
                  <button type="button" (click)="openSettingsSection('website-forms')">Website Forms</button>
                  <button type="button" (click)="openSettingsSection('calendar-accounts')">Calendar Accounts</button>
                  <button type="button" (click)="openSettingsSection('task-templates')">Task Templates</button>
                  <button type="button" (click)="openSettingsSection('report-schedules')">Report Schedules</button>
                  <button type="button" (click)="openSettingsSection('email-accounts')">Email Accounts</button>
                  <button type="button" (click)="openSettingsSection('users')">Users & Roles</button>
                </div>
              }
            </div>

            <button class="primary-btn" (click)="openDrawer()">+ New Enquiry</button>
          }

          <button class="avatar" (click)="logout()" [title]="displayName + ' (Sign out)'">{{ initials }}</button>
        </div>
      </div>
    </header>

    <main class="content">
      <div class="content-inner">
        <router-outlet></router-outlet>
      </div>
    </main>
  </section>

  @if (isAssistantOpen && canUseAssistant) {
    <aside class="assistant-panel" (click)="$event.stopPropagation()">
      <header class="assistant-header">
        <div>
          <h3>AI Assistant</h3>
          <p>Natural-language insights, summaries and drafting help.</p>
        </div>
        <button type="button" class="icon-btn" (click)="isAssistantOpen = false">&#10005;</button>
      </header>

      <div class="assistant-quick-actions">
        <button type="button" (click)="loadDailyBriefing()">Daily Briefing</button>
        <button type="button" (click)="loadMeetingPrep()">Meeting Prep</button>
        <button type="button" [disabled]="!currentEnquiryIdFromUrl" (click)="loadCurrentEnquirySummary()">Enquiry Summary</button>
      </div>

      <div class="assistant-thread">
        @for (message of assistantMessages; track message.id) {
          <article class="assistant-message" [class.user]="message.role === 'user'">
            <div class="meta">
              <strong>{{ message.role === 'user' ? 'You' : 'Assistant' }}</strong>
              @if (message.intent && message.role !== 'user') {
                <em>{{ message.intent }}</em>
              }
              <span>{{ message.generatedAtUtc | date: 'dd/MM HH:mm' }}</span>
            </div>
            <p>{{ message.text }}</p>

            @if (message.actions?.length) {
              <div class="assistant-actions">
                @for (action of message.actions || []; track action.key) {
                  <button type="button" (click)="runAssistantAction(action)">{{ action.label }}</button>
                }
              </div>
            }

            @if (message.suggestions?.length) {
              <div class="assistant-suggestions">
                @for (suggestion of message.suggestions || []; track suggestion) {
                  <button type="button" (click)="runAssistantSuggestion(suggestion)">{{ suggestion }}</button>
                }
              </div>
            }
          </article>
        }

        @if (assistantLoading) {
          <p class="assistant-loading">Assistant is thinking...</p>
        }

        @if (assistantError) {
          <p class="assistant-error">{{ assistantError }}</p>
        }

        @if (!assistantLoading && assistantMessages.length === 0 && !assistantError) {
          <p class="assistant-empty">Ask: "What's my pipeline looking like this month?"</p>
        }
      </div>

      <form class="assistant-input" (submit)="sendAssistantPrompt($event)">
        <select [(ngModel)]="assistantTone" name="assistantTone">
          <option value="friendly">Friendly</option>
          <option value="formal">Formal</option>
          <option value="urgent">Urgent</option>
        </select>
        <input
          type="text"
          [ngModel]="assistantPrompt"
          (ngModelChange)="assistantPrompt = $event"
          name="assistantPrompt"
          placeholder="Ask about pipeline, follow-ups, revenue, or draft emails"
        />
        <button type="submit" [disabled]="assistantLoading || !assistantPrompt.trim()">Send</button>
      </form>
    </aside>
  }

  @if (isDrawerOpen) {
    <div class="drawer-backdrop" (click)="closeDrawer()"></div>
  }

  @if (isCreateVenueOpen) {
    <div class="create-venue-backdrop" (click)="closeCreateVenueModal()"></div>
    <aside class="create-venue-modal" (click)="$event.stopPropagation()">
      <div class="drawer-header">
        <div>
          <h2>Create New Venue</h2>
          <p>This venue will be added to your group and available in the venue selector.</p>
        </div>
        <button class="icon-btn" type="button" (click)="closeCreateVenueModal()">&#10005;</button>
      </div>

      <form class="create-venue-form" [formGroup]="createVenueForm" (ngSubmit)="submitCreateVenue()">
        @if (createVenueError) {
          <p class="form-error">{{ createVenueError }}</p>
        }

        <label>
          Venue name
          <input type="text" formControlName="name" placeholder="e.g. Grand Country Manor" />
        </label>

        <label>
          Time zone
          <input type="text" formControlName="timeZone" placeholder="Europe/London" />
        </label>

        <label>
          Currency code
          <input type="text" formControlName="currencyCode" placeholder="GBP" maxlength="8" />
        </label>

        <label>
          Locale
          <input type="text" formControlName="locale" placeholder="en-GB" maxlength="12" />
        </label>

        <label>
          Country code
          <input type="text" formControlName="countryCode" placeholder="GB" maxlength="8" />
        </label>

        <label>
          Enquiries email (optional)
          <input type="email" formControlName="enquiriesEmail" placeholder="events@venue.co.uk" />
        </label>

        <div class="create-venue-actions">
          <button type="button" class="btn-secondary" (click)="closeCreateVenueModal()">Cancel</button>
          <button type="submit" class="btn-primary" [disabled]="isCreatingVenue">
            {{ isCreatingVenue ? 'Creating...' : 'Create Venue' }}
          </button>
        </div>
      </form>
    </aside>
  }

  <aside class="drawer" [class.open]="isDrawerOpen">
    <div class="drawer-header">
      <div>
        <h2>New Event Enquiry</h2>
        <p>Status starts as New. Phone number is required.</p>
      </div>
      <button class="icon-btn" (click)="closeDrawer()">&#10005;</button>
    </div>

    <form class="drawer-form" [formGroup]="enquiryForm" (ngSubmit)="submitEnquiry()">
      @if (submissionError) {
        <p class="form-error">{{ submissionError }}</p>
      }

      <label>
        First Name
        <input type="text" formControlName="contactFirstName" />
      </label>

      <label>
        Last Name
        <input type="text" formControlName="contactLastName" />
      </label>

      <label>
        Email
        <input type="email" formControlName="contactEmail" />
      </label>

      <label>
        Phone (E.164)
        <input type="text" formControlName="contactPhoneNumberE164" placeholder="+447700900111" />
      </label>

      @if (duplicateCheckLoading) {
        <p class="advisory-note">Checking existing contacts and enquiries...</p>
      }

      @if (hasDuplicateAdvisory && primaryDuplicateMatch; as duplicateMatch) {
        <section class="advisory-banner">
          <p>
            Possible duplicate: <strong>{{ duplicateMatch.contactName }}</strong> has an existing enquiry
            <strong>{{ duplicateMatch.reference }}</strong> for
            <strong>{{ duplicateMatch.eventName }}</strong> on
            <strong>{{ duplicateMatch.eventStartUtc | date: 'dd/MM/yyyy' }}</strong>. View existing enquiry.
            @if ((duplicateCheck?.duplicateMatches?.length ?? 0) > 1) {
              <span> +{{ (duplicateCheck?.duplicateMatches?.length ?? 1) - 1 }} additional possible match(es).</span>
            }
          </p>
          <div class="advisory-actions">
            <button type="button" class="inline-link" (click)="openDuplicateWarningModal()">Review duplicate options</button>
          </div>
        </section>
      }

      <label>
        Company
        <input type="text" formControlName="companyName" />
      </label>

      <label>
        Event Type
        <select formControlName="eventType">
          <option>Wedding</option>
          <option>Corporate Conference</option>
          <option>Private Dining</option>
          <option>Christmas Party</option>
          <option>Birthday</option>
          <option>Funeral/Wake</option>
          <option>Charity</option>
          <option>Product Launch</option>
          <option>Team Building</option>
          <option>Other</option>
        </select>
      </label>

      <label>
        Event Name
        <input type="text" formControlName="eventName" />
      </label>

      <label>
        Event Date
        <input type="date" formControlName="eventDate" />
      </label>

      @if (hasDateConflictAdvisory && primarySameDateConflict; as sameDateConflict) {
        <section class="advisory-banner">
          <p>
            Potential double-booking: <strong>{{ sameDateConflict.reference }}</strong> ({{ sameDateConflict.status }})
            for <strong>{{ sameDateConflict.eventName }}</strong> on
            <strong>{{ sameDateConflict.eventStartUtc | date: 'dd/MM/yyyy' }}</strong>.
            @if ((duplicateCheck?.sameDateConflicts?.length ?? 0) > 1) {
              <span> +{{ (duplicateCheck?.sameDateConflicts?.length ?? 1) - 1 }} additional enquiry conflict(s).</span>
            }
          </p>
          <div class="advisory-actions">
            <button type="button" class="inline-link" (click)="openDuplicateWarningModal()">Review duplicate options</button>
          </div>
        </section>
      }

      <label>
        Start Time
        <input type="time" formControlName="eventTime" />
      </label>

      <label>
        Event Style
        <select formControlName="eventStyle">
          <option>Meeting</option>
          <option>3-Course Dinner</option>
          <option>Buffet</option>
          <option>Reception/Standing</option>
          <option>BBQ</option>
          <option>Afternoon Tea</option>
          <option>Drinks Reception</option>
          <option>Custom</option>
        </select>
      </label>

      <label>
        Setup Style
        <select formControlName="setupStyle">
          <option>Theatre</option>
          <option>Banquet</option>
          <option>Boardroom</option>
          <option>Cabaret</option>
          <option>Reception</option>
          <option>Classroom</option>
          <option>U-Shape</option>
          <option>Custom</option>
        </select>
      </label>

      <label>
        Guests
        <input type="number" min="1" formControlName="guestsExpected" />
      </label>

      <label>
        Budget Min
        <input type="number" min="0" formControlName="budgetMinAmount" />
      </label>

      <label>
        Budget Max
        <input type="number" min="0" formControlName="budgetMaxAmount" />
      </label>

      <label>
        Source
        <select formControlName="sourceType">
          <option>Phone</option>
          <option>Walk-in</option>
          <option>Referral</option>
          <option>Social Media</option>
          <option>Venue Event</option>
          <option>Third-Party</option>
          <option>Returning Client</option>
          <option>Website Form</option>
          <option>Email</option>
        </select>
      </label>

      <label>
        Source Detail
        <input type="text" formControlName="sourceDetail" />
      </label>

      <label>
        Lead Quality (1-5)
        <input type="number" min="1" max="5" formControlName="leadQuality" />
      </label>

      <label class="checkbox">
        <input type="checkbox" formControlName="marketingConsent" />
        <span>Marketing consent</span>
      </label>

      <label class="checkbox">
        <input type="checkbox" formControlName="hasFlexibleDates" />
        <span>Flexible dates</span>
      </label>

      <label class="full">
        Flexible Date Notes
        <textarea rows="2" formControlName="flexibleDateNotes"></textarea>
      </label>

      <label class="full">
        Special Requirements
        <textarea rows="2" formControlName="specialRequirements"></textarea>
      </label>

      <label class="full">
        Internal Notes
        <textarea rows="3" formControlName="internalNotes"></textarea>
      </label>

      @if (availability) {
        <section class="availability">
          <h3>Same-date availability</h3>
          @for (group of availability.spaces; track group.spaceId) {
            <article>
              <header>
                <strong>{{ group.spaceName }}</strong>
                @if (group.isAvailable) {
                  <span class="available">Available</span>
                } @else {
                  <span class="busy">Busy</span>
                }
              </header>
              @for (event of group.events; track event.recordId) {
                <div class="availability-event">
                  <strong>{{ event.label }}</strong>
                  <span>{{ event.recordType }} · {{ event.startUtc | date: 'HH:mm' }}-{{ event.endUtc | date: 'HH:mm' }}</span>
                  @if (event.enquiryStatus) {
                    <span>{{ event.enquiryStatus }} · {{ event.covers }} covers</span>
                  }
                </div>
              }
            </article>
          }
        </section>
      }

      <div class="drawer-actions">
        <button type="button" class="ghost-btn" (click)="closeDrawer()">Cancel</button>
        <button type="submit" class="primary-btn" [disabled]="isSubmitting">
          {{ isSubmitting ? 'Creating...' : 'Create Enquiry' }}
        </button>
      </div>
    </form>
  </aside>

  @if (showDuplicateWarningModal) {
    <button type="button" class="duplicate-modal-backdrop" (click)="closeDuplicateWarningModal()" aria-label="Close duplicate warning"></button>
    <aside class="duplicate-modal" (click)="$event.stopPropagation()">
      <header class="duplicate-modal-header">
        <div>
          <h3>Possible duplicate detected</h3>
          <p>Review existing enquiries before creating a new one.</p>
        </div>
        <button type="button" class="icon-btn" (click)="closeDuplicateWarningModal()">&#10005;</button>
      </header>

      <section class="duplicate-modal-body">
        @if (duplicateModalMatches.length > 0) {
          <h4>Matching contacts</h4>
          <div class="duplicate-list">
            @for (match of duplicateModalMatches; track match.enquiryId) {
              <label>
                <input
                  type="radio"
                  name="duplicateSelection"
                  [value]="match.enquiryId"
                  [checked]="selectedDuplicateEnquiryId === match.enquiryId"
                  (change)="selectedDuplicateEnquiryId = match.enquiryId" />
                <span>
                  <strong>{{ match.reference }}</strong> · {{ match.contactName }} · {{ match.eventName }} · {{ match.eventStartUtc | date: 'dd/MM/yyyy' }}
                  <em>{{ match.status }}</em>
                </span>
              </label>
            }
          </div>
        }

        @if (duplicateModalConflicts.length > 0) {
          <h4>Same-date conflicts</h4>
          <div class="duplicate-list">
            @for (conflict of duplicateModalConflicts; track conflict.enquiryId) {
              <label>
                <input
                  type="radio"
                  name="duplicateSelection"
                  [value]="conflict.enquiryId"
                  [checked]="selectedDuplicateEnquiryId === conflict.enquiryId"
                  (change)="selectedDuplicateEnquiryId = conflict.enquiryId" />
                <span>
                  <strong>{{ conflict.reference }}</strong> · {{ conflict.contactName }} · {{ conflict.eventName }} · {{ conflict.eventStartUtc | date: 'dd/MM/yyyy' }}
                  <em>{{ conflict.status }}</em>
                </span>
              </label>
            }
          </div>
        }
      </section>

      <footer class="duplicate-modal-actions">
        <button type="button" class="ghost-btn" (click)="createEnquiryAnyway()">Create Anyway</button>
        <button type="button" class="ghost-btn" (click)="viewDuplicateSelection()">View Existing</button>
        <button type="button" class="primary-btn" (click)="openMergeFromDuplicateWarning()">Merge</button>
      </footer>
    </aside>
  }
</div>
